{- |
Module      :  <TestImport>
Description :  <Test Cases for Persist Mongo Template>
Copyright   :  (c) <Plow Technology 2014>
License     :  <MIT>

Maintainer  :  <lingpo.huang@plowtech.net>
Stability   :  unstable
Portability :  portable

<Parse String for OnpingTagCombined>
-}
{-# LANGUAGE OverloadedStrings #-}
module TestImport where

import           Data.Aeson
import           Data.ByteString.Lazy.Internal
import           Database.Persist.Types
import           Persist.Mongo.Settings

testOnpingTagCombinedJSON :: ByteString
testOnpingTagCombinedJSON = "{\"unit_id\":0,\"status_active\":1,\"location\":null,\"parameter_tag_id\":6,\"result\":\"1\",\"slave_parameter_id\":1,\"validation_code\":\"<?php\\n    //This is generated code provided by the OnPing System to assist\\n    //you the person setup this parameter for writing to it.\\n    //All you have to do is fill in the gaps and uncomment code when needed.\\n\\t\\n    //Variable Section, DO NOT EDIT\\n    $result = false;\\n    $header_text = \\\"\\\";\\n    $error_text = \\\"\\\";\\n    $user_input = \\\"\\\";\\n    $user_input_calculated = \\\"\\\";\\n    $write_tag_name = \\\"\\\";\\n    $write_enable_tag_name = \\\"\\\";\\n    $user_input = [OnPing.USER INPUT];\\n    //End of Variable Section\\n\\t\\n    //****************** Start the editing process *************************\\n    //This value will be on top of the remote control popup\\n    $header_text = \\\"Writing to this parameter\\\";\\n    $write_parameter_target = -1;\\n    $slave_id = -1;\\n\\n    //If the PLC is running the standard PLC program\\n    $is_standard_plc = true;\\n    $is_rw_reg = true;\\n\\t\\n    if($is_rw_reg)\\n    {\\n        $write_tag_name = \\\"Write_Slave_RWReg_Value_Web\\\";\\n        $write_enable_tag_name = \\\"Write_Slave_RWReg_Value_Enable_Web\\\";\\n    }\\n    else\\n    {\\n        $write_tag_name = \\\"Write_Slave_RWCoil_Value_Web\\\";\\n        $write_enable_tag_name = \\\"Write_Slave_RWCoil_Value_Enable_Web\\\";\\n    }\\n\\t\\n    if($user_input != \\\"\\\")     //DO NOT DELETE THIS IF STATEMENT CRITICAL\\n    {\\n        //This will format the user input for standard input\\n        //I.E. If the user input 12.1 and you need to write 121 you would multiple by 10\\n        $user_input_calculated = $user_input * 10;\\t\\n\\t\\t\\n        //Below is a sample condition\\n        $min = 1;\\n        $max = 4;\\n        if($user_input >= $min && $user_input <= $max)\\n        {\\n            $result = true;\\n        }\\n        else\\n        {\\n            $error_text = \\\"The value {$user_input} is not between {$min} and {$max}\\\";\\n            $result = false;\\n        }\\n    }\\n\\t\\n    //Do not touch the below this like unless you know what you are doing.\\n    //This echo of this page must be an array structured in this very same format.\\n    $write_data = array();\\n    $write_data['header_text'] = $header_text;\\n    $write_data['error_text'] = $error_text;\\n    $write_data['user_input'] = $user_input;\\n    $write_data['user_input_calculated'] = $user_input_calculated;\\n    $write_data['write_parameter_target'] = $write_parameter_target;\\n    $write_data['result'] = ($result)?\\\"Success\\\":\\\"Error\\\";\\n    if($is_standard_plc)\\n        $write_data['command'] = \\\"write -protocol control_logix -writetagname {$write_tag_name} -enabletagname {$write_enable_tag_name} -slaveid {$slave_id} -parameterid {$write_parameter_target} -occurrence Once {$user_input_calculated}\\\";\\n    else\\n    {\\n        $write_data['command'] = \\\"\\\";\\n    }\\n    echo $write_data;\\n?>\",\"last_update\":\"2013-10-08T19:40:32.085Z\",\"company\":2,\"location_id\":209,\"pid\":4776,\"permissions\":0,\"site\":3,\"description\":\"Comm Status\",\"delete\":0,\"status_writable\":0}"

parseOnpingTagCombined :: ByteString -> Maybe OnpingTagCombined
parseOnpingTagCombined pt = decode pt :: Maybe OnpingTagCombined

parseOnpingTagCombinedEntity :: ByteString -> Maybe (Entity OnpingTagCombined)
parseOnpingTagCombinedEntity e = decode e :: Maybe (Entity OnpingTagCombined)

testOnpingTagCombinedEntityJSON :: ByteString
testOnpingTagCombinedEntityJSON = "{\"value\":{\"unit_id\":0,\"status_active\":1,\"location\":null,\"parameter_tag_id\":6,\"result\":\"1\",\"slave_parameter_id\":1,\"validation_code\":\"<?php\\n    //This is generated code provided by the OnPing System to assist\\n    //you the person setup this parameter for writing to it.\\n    //All you have to do is fill in the gaps and uncomment code when needed.\\n\\t\\n    //Variable Section, DO NOT EDIT\\n    $result = false;\\n    $header_text = \\\"\\\";\\n    $error_text = \\\"\\\";\\n    $user_input = \\\"\\\";\\n    $user_input_calculated = \\\"\\\";\\n    $write_tag_name = \\\"\\\";\\n    $write_enable_tag_name = \\\"\\\";\\n    $user_input = [OnPing.USER INPUT];\\n    //End of Variable Section\\n\\t\\n    //****************** Start the editing process *************************\\n    //This value will be on top of the remote control popup\\n    $header_text = \\\"Writing to this parameter\\\";\\n    $write_parameter_target = -1;\\n    $slave_id = -1;\\n\\n    //If the PLC is running the standard PLC program\\n    $is_standard_plc = true;\\n    $is_rw_reg = true;\\n\\t\\n    if($is_rw_reg)\\n    {\\n        $write_tag_name = \\\"Write_Slave_RWReg_Value_Web\\\";\\n        $write_enable_tag_name = \\\"Write_Slave_RWReg_Value_Enable_Web\\\";\\n    }\\n    else\\n    {\\n        $write_tag_name = \\\"Write_Slave_RWCoil_Value_Web\\\";\\n        $write_enable_tag_name = \\\"Write_Slave_RWCoil_Value_Enable_Web\\\";\\n    }\\n\\t\\n    if($user_input != \\\"\\\")     //DO NOT DELETE THIS IF STATEMENT CRITICAL\\n    {\\n        //This will format the user input for standard input\\n        //I.E. If the user input 12.1 and you need to write 121 you would multiple by 10\\n        $user_input_calculated = $user_input * 10;\\t\\n\\t\\t\\n        //Below is a sample condition\\n        $min = 1;\\n        $max = 4;\\n        if($user_input >= $min && $user_input <= $max)\\n        {\\n            $result = true;\\n        }\\n        else\\n        {\\n            $error_text = \\\"The value {$user_input} is not between {$min} and {$max}\\\";\\n            $result = false;\\n        }\\n    }\\n\\t\\n    //Do not touch the below this like unless you know what you are doing.\\n    //This echo of this page must be an array structured in this very same format.\\n    $write_data = array();\\n    $write_data['header_text'] = $header_text;\\n    $write_data['error_text'] = $error_text;\\n    $write_data['user_input'] = $user_input;\\n    $write_data['user_input_calculated'] = $user_input_calculated;\\n    $write_data['write_parameter_target'] = $write_parameter_target;\\n    $write_data['result'] = ($result)?\\\"Success\\\":\\\"Error\\\";\\n    if($is_standard_plc)\\n        $write_data['command'] = \\\"write -protocol control_logix -writetagname {$write_tag_name} -enabletagname {$write_enable_tag_name} -slaveid {$slave_id} -parameterid {$write_parameter_target} -occurrence Once {$user_input_calculated}\\\";\\n    else\\n    {\\n        $write_data['command'] = \\\"\\\";\\n    }\\n    echo $write_data;\\n?>\",\"last_update\":\"2013-10-08T19:40:32.085Z\",\"company\":2,\"location_id\":209,\"pid\":4776,\"permissions\":0,\"site\":3,\"description\":\"Comm Status\",\"delete\":0,\"status_writable\":0},\"key\":\"o522ed1465b8f0605a700003e\"}"
